opcode trigger,i,k[]iiii
  kdurs,istart,im,idx,is xin
  
  iy = i(kdurs,istart)
  if (im<is+iy) then
   iout = idx
  else 
   iout = trigger(idurs,istart+1,im,idx+1,is+iy)
  endif
  xout iout
endop

opcode trigger,i,k[]i
  kdurs,im xin 
  isum = i(sumarray(kdurs))
  
  if (im >= isum) then
    iout = trigger(kdurs, im-isum)
  else
    iout = trigger(kdurs, 0, im, 0, 0)
  endif
  xout iout
endop

opcode trigger,i,k[]
  kdurs xin
  xout trigger(kdurs, now_tick())
endop  