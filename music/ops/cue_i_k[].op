opcode cue5,i,k[]iiii
  kdurs[],istart,im,idx,is xin
  
  iy = i(kdurs,istart)
  if (im<is+iy) then
   iout = idx
  else 
   iout = cue5(kdurs,istart+1,im,idx+1,is+iy)
  endif
  xout iout
endop

opcode cue2,i,k[]i
  kdurs[],im xin 
  ksum = sumarray(kdurs)
  isum = i(ksum)
  
  if (im >= isum) then
    iout = cue2(kdurs, im-isum)
  else
    iout = cue5(kdurs, 0, im, 0, 0)
  endif
  xout iout
endop

opcode cue,i,k[]
  kdurs[] xin
  xout cue2(kdurs, now_tick())
endop 
